

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TFG.problems package &mdash; TFG 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=888ff710"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TFG
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">TFG.problems package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-TFG.problems.clas_problem">TFG.problems.clas_problem module</a><ul>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem"><code class="docutils literal notranslate"><span class="pre">ClasProblem</span></code></a><ul>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.X"><code class="docutils literal notranslate"><span class="pre">ClasProblem.X</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.Y"><code class="docutils literal notranslate"><span class="pre">ClasProblem.Y</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.X_gpu"><code class="docutils literal notranslate"><span class="pre">ClasProblem.X_gpu</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.Y_gpu"><code class="docutils literal notranslate"><span class="pre">ClasProblem.Y_gpu</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.n_samples"><code class="docutils literal notranslate"><span class="pre">ClasProblem.n_samples</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.n_features"><code class="docutils literal notranslate"><span class="pre">ClasProblem.n_features</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.threshold"><code class="docutils literal notranslate"><span class="pre">ClasProblem.threshold</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.alpha"><code class="docutils literal notranslate"><span class="pre">ClasProblem.alpha</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.__init__"><code class="docutils literal notranslate"><span class="pre">ClasProblem.__init__()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.generate_solution"><code class="docutils literal notranslate"><span class="pre">ClasProblem.generate_solution()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.fitness"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.fitness_omp"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.fitness_gpu"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.fitness_gpu2"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_gpu2()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.fitness_hybrid"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.clas_rate"><code class="docutils literal notranslate"><span class="pre">ClasProblem.clas_rate()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.red_rate"><code class="docutils literal notranslate"><span class="pre">ClasProblem.red_rate()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.predict"><code class="docutils literal notranslate"><span class="pre">ClasProblem.predict()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.crossover"><code class="docutils literal notranslate"><span class="pre">ClasProblem.crossover()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.mutation"><code class="docutils literal notranslate"><span class="pre">ClasProblem.mutation()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.initialize_pheromones"><code class="docutils literal notranslate"><span class="pre">ClasProblem.initialize_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.construct_solutions"><code class="docutils literal notranslate"><span class="pre">ClasProblem.construct_solutions()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.update_pheromones"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.reset_pheromones"><code class="docutils literal notranslate"><span class="pre">ClasProblem.reset_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.generate_velocity"><code class="docutils literal notranslate"><span class="pre">ClasProblem.generate_velocity()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.update_velocity"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_velocity()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.clas_problem.ClasProblem.update_position"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_position()</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">ClasProblem.clas_rate()</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">ClasProblem.construct_solutions()</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">ClasProblem.crossover()</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_gpu2()</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">ClasProblem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">ClasProblem.generate_solution()</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">ClasProblem.generate_velocity()</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">ClasProblem.initialize_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">ClasProblem.mutation()</span></code></a></li>
<li><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">ClasProblem.predict()</span></code></a></li>
<li><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">ClasProblem.red_rate()</span></code></a></li>
<li><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">ClasProblem.reset_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_position()</span></code></a></li>
<li><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">ClasProblem.update_velocity()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-TFG.problems.problem">TFG.problems.problem module</a><ul>
<li><a class="reference internal" href="#classes">Classes:</a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem"><code class="docutils literal notranslate"><span class="pre">Problem</span></code></a><ul>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.None"><code class="docutils literal notranslate"><span class="pre">Problem.None</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.generate_solution"><code class="docutils literal notranslate"><span class="pre">Problem.generate_solution()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.fitness"><code class="docutils literal notranslate"><span class="pre">Problem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.fitness_omp"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.fitness_gpu"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.problem.Problem.fitness_hybrid"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">Problem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">Problem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">Problem.generate_solution()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#TFG.problems.problem.patch_problem"><code class="docutils literal notranslate"><span class="pre">patch_problem()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-TFG.problems.tsp_problem">TFG.problems.tsp_problem module</a><ul>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem"><code class="docutils literal notranslate"><span class="pre">TSPProblem</span></code></a><ul>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.distances"><code class="docutils literal notranslate"><span class="pre">TSPProblem.distances</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.distances_gpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.distances_gpu</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.n_cities"><code class="docutils literal notranslate"><span class="pre">TSPProblem.n_cities</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.execution"><code class="docutils literal notranslate"><span class="pre">TSPProblem.execution</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.generate_solution"><code class="docutils literal notranslate"><span class="pre">TSPProblem.generate_solution()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.fitness"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.fitness_omp"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.fitness_gpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.fitness_hybrid"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.crossover"><code class="docutils literal notranslate"><span class="pre">TSPProblem.crossover()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.crossover_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.crossover_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.mutation"><code class="docutils literal notranslate"><span class="pre">TSPProblem.mutation()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.initialize_pheromones"><code class="docutils literal notranslate"><span class="pre">TSPProblem.initialize_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.initialize_pheromones_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.initialize_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu_multi"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions_cpu_multi()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_pheromones"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_pheromones_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.reset_pheromones"><code class="docutils literal notranslate"><span class="pre">TSPProblem.reset_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.reset_pheromones_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.reset_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.generate_velocity"><code class="docutils literal notranslate"><span class="pre">TSPProblem.generate_velocity()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_velocity"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_velocity()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_velocity_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_velocity_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.two_opt_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.two_opt_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.two_opt"><code class="docutils literal notranslate"><span class="pre">TSPProblem.two_opt()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_position"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_position_cpu"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.tsp_problem.TSPProblem.update_position_cpu_multi"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position_cpu_multi()</span></code></a></li>
<li><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions()</span></code></a></li>
<li><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">TSPProblem.construct_solutions_cpu_multi()</span></code></a></li>
<li><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">TSPProblem.crossover()</span></code></a></li>
<li><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">TSPProblem.crossover_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness()</span></code></a></li>
<li><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_gpu()</span></code></a></li>
<li><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#id31"><code class="docutils literal notranslate"><span class="pre">TSPProblem.fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">TSPProblem.generate_solution()</span></code></a></li>
<li><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">TSPProblem.generate_velocity()</span></code></a></li>
<li><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">TSPProblem.initialize_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id35"><code class="docutils literal notranslate"><span class="pre">TSPProblem.initialize_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id36"><code class="docutils literal notranslate"><span class="pre">TSPProblem.mutation()</span></code></a></li>
<li><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">TSPProblem.reset_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id38"><code class="docutils literal notranslate"><span class="pre">TSPProblem.reset_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id39"><code class="docutils literal notranslate"><span class="pre">TSPProblem.two_opt()</span></code></a></li>
<li><a class="reference internal" href="#id40"><code class="docutils literal notranslate"><span class="pre">TSPProblem.two_opt_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id41"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_pheromones()</span></code></a></li>
<li><a class="reference internal" href="#id42"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_pheromones_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id43"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position()</span></code></a></li>
<li><a class="reference internal" href="#id44"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position_cpu()</span></code></a></li>
<li><a class="reference internal" href="#id45"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_position_cpu_multi()</span></code></a></li>
<li><a class="reference internal" href="#id46"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_velocity()</span></code></a></li>
<li><a class="reference internal" href="#id47"><code class="docutils literal notranslate"><span class="pre">TSPProblem.update_velocity_cpu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-TFG.problems.utils">TFG.problems.utils module</a><ul>
<li><a class="reference internal" href="#TFG.problems.utils.clas_rate"><code class="docutils literal notranslate"><span class="pre">clas_rate()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.construct_solutions_tsp_inner"><code class="docutils literal notranslate"><span class="pre">construct_solutions_tsp_inner()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.construct_solutions_tsp_inner_cpu"><code class="docutils literal notranslate"><span class="pre">construct_solutions_tsp_inner_cpu()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.crossover_tsp"><code class="docutils literal notranslate"><span class="pre">crossover_tsp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.fitness"><code class="docutils literal notranslate"><span class="pre">fitness()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.fitness_omp"><code class="docutils literal notranslate"><span class="pre">fitness_omp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.fitness_tsp"><code class="docutils literal notranslate"><span class="pre">fitness_tsp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.fitness_tsp_omp"><code class="docutils literal notranslate"><span class="pre">fitness_tsp_omp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.get_swap_sequence"><code class="docutils literal notranslate"><span class="pre">get_swap_sequence()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.mutation_tsp"><code class="docutils literal notranslate"><span class="pre">mutation_tsp()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.red_rate"><code class="docutils literal notranslate"><span class="pre">red_rate()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.two_opt"><code class="docutils literal notranslate"><span class="pre">two_opt()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils.update_pheromones_tsp"><code class="docutils literal notranslate"><span class="pre">update_pheromones_tsp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-TFG.problems.utils_gpu">TFG.problems.utils_gpu module</a><ul>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.create_capsule"><code class="docutils literal notranslate"><span class="pre">create_capsule()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.fitness_cuda"><code class="docutils literal notranslate"><span class="pre">fitness_cuda()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.fitness_hybrid"><code class="docutils literal notranslate"><span class="pre">fitness_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.fitness_tsp_cuda"><code class="docutils literal notranslate"><span class="pre">fitness_tsp_cuda()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.fitness_tsp_hybrid"><code class="docutils literal notranslate"><span class="pre">fitness_tsp_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#TFG.problems.utils_gpu.warmup"><code class="docutils literal notranslate"><span class="pre">warmup()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-TFG.problems">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TFG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">TFG.problems package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/TFG.problems.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tfg-problems-package">
<h1>TFG.problems package<a class="headerlink" href="#tfg-problems-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-TFG.problems.clas_problem">
<span id="tfg-problems-clas-problem-module"></span><h2>TFG.problems.clas_problem module<a class="headerlink" href="#module-TFG.problems.clas_problem" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TFG.problems.clas_problem.</span></span><span class="sig-name descname"><span class="pre">ClasProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#TFG.problems.problem.Problem" title="TFG.problems.problem.Problem"><code class="xref py py-class docutils literal notranslate"><span class="pre">Problem</span></code></a></p>
<p>ClasProblem is a classification problem class designed for feature selection and optimization using evolutionary and swarm-based algorithms. It supports CPU and GPU (CuPy) acceleration for fitness evaluation and provides methods for solution generation, evaluation, and population management.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.X">
<span class="sig-name descname"><span class="pre">X</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.X" title="Link to this definition"></a></dt>
<dd><p>Feature matrix (CPU).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.Y">
<span class="sig-name descname"><span class="pre">Y</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.Y" title="Link to this definition"></a></dt>
<dd><p>Label vector (CPU).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.X_gpu">
<span class="sig-name descname"><span class="pre">X_gpu</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.X_gpu" title="Link to this definition"></a></dt>
<dd><p>Feature matrix (GPU).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.Y_gpu">
<span class="sig-name descname"><span class="pre">Y_gpu</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.Y_gpu" title="Link to this definition"></a></dt>
<dd><p>Label vector (GPU).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.n_features" title="Link to this definition"></a></dt>
<dd><p>Number of features in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.threshold" title="Link to this definition"></a></dt>
<dd><p>Threshold for feature selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.alpha" title="Link to this definition"></a></dt>
<dd><p>Weighting factor for classification vs. reduction rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the ClasProblem instance with data and parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.generate_solution">
<span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.generate_solution" title="Link to this definition"></a></dt>
<dd><p>Generates random solutions for the feature selection problem.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.fitness">
<span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.fitness" title="Link to this definition"></a></dt>
<dd><p>Evaluates the fitness of solutions using a CPU-based function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.fitness_omp">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.fitness_omp" title="Link to this definition"></a></dt>
<dd><p>Evaluates the fitness of solutions using an OpenMP-accelerated function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.fitness_gpu">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.fitness_gpu" title="Link to this definition"></a></dt>
<dd><p>Evaluates the fitness of solutions using GPU acceleration (CuPy).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.fitness_gpu2">
<span class="sig-name descname"><span class="pre">fitness_gpu2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_gpu2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.fitness_gpu2" title="Link to this definition"></a></dt>
<dd><p>Alternative GPU-based fitness evaluation using custom CUDA kernels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.fitness_hybrid">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.fitness_hybrid" title="Link to this definition"></a></dt>
<dd><p>Hybrid fitness evaluation combining CPU and GPU methods.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.clas_rate">
<span class="sig-name descname"><span class="pre">clas_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.clas_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.clas_rate" title="Link to this definition"></a></dt>
<dd><p>Computes the classification accuracy rate for a given solution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.red_rate">
<span class="sig-name descname"><span class="pre">red_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.red_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.red_rate" title="Link to this definition"></a></dt>
<dd><p>Computes the feature reduction rate for a given solution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.predict" title="Link to this definition"></a></dt>
<dd><p>Predicts labels for test data using the selected features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.crossover">
<span class="sig-name descname"><span class="pre">crossover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.crossover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.crossover" title="Link to this definition"></a></dt>
<dd><p>Performs crossover operation on the population for evolutionary algorithms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.mutation">
<span class="sig-name descname"><span class="pre">mutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.mutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.mutation" title="Link to this definition"></a></dt>
<dd><p>Applies mutation to the population.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.initialize_pheromones">
<span class="sig-name descname"><span class="pre">initialize_pheromones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.initialize_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.initialize_pheromones" title="Link to this definition"></a></dt>
<dd><p>Initializes pheromone means and standard deviations for ACO algorithms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.construct_solutions">
<span class="sig-name descname"><span class="pre">construct_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.construct_solutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.construct_solutions" title="Link to this definition"></a></dt>
<dd><p>Constructs new solutions based on pheromone information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.update_pheromones">
<span class="sig-name descname"><span class="pre">update_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.update_pheromones" title="Link to this definition"></a></dt>
<dd><p>Updates pheromone values based on colony performance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.reset_pheromones">
<span class="sig-name descname"><span class="pre">reset_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.reset_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.reset_pheromones" title="Link to this definition"></a></dt>
<dd><p>Resets pheromones to initial values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.generate_velocity">
<span class="sig-name descname"><span class="pre">generate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.generate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.generate_velocity" title="Link to this definition"></a></dt>
<dd><p>Generates random velocities for PSO algorithms.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.update_velocity">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.update_velocity" title="Link to this definition"></a></dt>
<dd><p>Updates particle velocities in PSO.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.clas_problem.ClasProblem.update_position">
<span class="sig-name descname"><span class="pre">update_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.clas_problem.ClasProblem.update_position" title="Link to this definition"></a></dt>
<dd><p>Updates particle positions in PSO, applying boundary constraints.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">clas_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.clas_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Calculates the classification rate for a given solution.
This method delegates the computation to the <cite>utils.clas_rate</cite> function,
passing the provided solution along with the instance’s feature matrix (self.X),
target labels (self.Y), and classification threshold (self.threshold).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> – The solution or model parameters to evaluate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The classification rate (accuracy) of the solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">construct_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.construct_solutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Constructs a set of candidate solutions for the colony using vectorized sampling
from normal distributions influenced by pheromone information and exploration/exploitation parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colony_size</strong> (<em>int</em>) – Number of solutions (ants) to generate.</p></li>
<li><p><strong>pheromones</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Tuple containing means and standard deviations
(means, stds) for each feature, representing the pheromone trails.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Parameter controlling exploitation; higher values increase exploitation
by reducing the influence of the mean.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Parameter controlling exploration; higher values increase exploration
by reducing the influence of the standard deviation.</p></li>
<li><p><strong>out</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Optional output array to store the generated solutions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of shape (colony_size, n_features) containing the generated solutions,
with values clipped to the [0.0, 1.0] range.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">crossover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.crossover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Performs blend crossover (BLX-alpha) on a population of individuals.
This method selects pairs of parents from the population and generates offspring by sampling uniformly within an extended range defined by the parents and the alpha parameter. The offspring replace the parents in the population. All resulting values are clipped to the [0, 1] range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – The population of individuals, where each individual is represented as a vector of real values.</p></li>
<li><p><strong>crossover_rate</strong> (<em>float</em>) – The proportion of the population to undergo crossover (between 0 and 1).</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – The BLX-alpha parameter that controls the extent of the sampling range beyond the parents’ values. Default is 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The population is modified in place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness value(s) for one or more solutions.
If a single solution is provided (1D array), computes its fitness directly.
If multiple solutions are provided (2D array), computes the fitness for each solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>np.ndarray</em>) – A single solution (1D array) or multiple solutions (2D array).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fitness value for the single solution, or an array of fitness values for multiple solutions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness values for a batch of solutions using GPU acceleration with CuPy.
This method evaluates each solution by applying feature selection and transformation,
then computes classification and reduction rates based on nearest neighbor predictions.
If GPU memory is insufficient, it falls back to an alternative implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>array-like</em><em> or </em><em>cupy.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_solutions</em><em>, </em><em>n_features</em><em>)</em>) – The set of candidate solutions to evaluate. Each row represents a solution
with feature weights or selection values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed fitness values for each solution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray, shape (n_solutions,)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The fitness is a weighted sum of classification accuracy and feature reduction rate,
controlled by the <cite>self.alpha</cite> parameter.</p></li>
<li><p>Uses GPU arrays (<cite>cupy</cite>) for efficient computation. Falls back to <cite>fitness_gpu2</cite>
if a GPU memory error occurs.</p></li>
<li><p>Assumes <cite>self.X_gpu</cite> (features), <cite>self.Y_gpu</cite> (labels), <cite>self.threshold</cite>,
<cite>self.n_features</cite>, and <cite>self.alpha</cite> are defined and reside on the GPU.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">fitness_gpu2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_gpu2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness value(s) for the given solution(s) using GPU acceleration.
This method transfers the input solutions to the GPU, prepares the necessary data capsules,
and calls a CUDA-accelerated fitness function. It supports both single-solution (1D array)
and multiple-solution (2D array) inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>numpy.ndarray</em><em> or </em><em>cupy.ndarray</em>) – An array of solutions to evaluate. Can be a 1D array (single solution) or a 2D array
(multiple solutions, shape: [n_solutions, n_features]).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed fitness value(s) for the input solution(s). Returns a single float if a
single solution is provided, or a numpy array of floats if multiple solutions are provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Requires GPU support and appropriate CUDA kernels via <cite>utils_gpu</cite>.</p></li>
<li><p>Synchronizes the GPU device before computation to ensure data consistency.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness values for a set of solutions using a hybrid CPU/GPU approach.
This method evaluates the fitness of one or more candidate solutions by leveraging a GPU-accelerated
function. It supports both single-solution and batch evaluation. The function also returns an updated
speedup value, which may be used to tune the GPU computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> (<em>np.ndarray</em>) – An array of candidate solutions to be evaluated. Can be a 1D array (single solution) or a 2D array
(multiple solutions).</p></li>
<li><p><strong>speedup</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – A parameter to control or record the speedup factor for GPU computation (default is 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fitness_values</strong> (<em>float or np.ndarray</em>) – The computed fitness value(s) for the provided solution(s). Returns a single float if a single
solution is provided, or a 1D numpy array of floats for multiple solutions.</p></li>
<li><p><strong>new_speedup</strong> (<em>int or float</em>) – The updated speedup value as returned by the GPU function.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness values for the given solutions using the OMP (Orthogonal Matching Pursuit) method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>np.ndarray</em>) – Array of candidate solutions. Can be a 1D array (single solution) or 2D array (multiple solutions).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitness values for the provided solutions. Returns a single float if a single solution is provided,
otherwise returns a 1D numpy array of fitness values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses the <cite>utils.fitness_omp</cite> function to perform the actual fitness computation.</p></li>
<li><p>The fitness is computed based on the input data <cite>self.X</cite>, target values <cite>self.Y</cite>, regularization parameter <cite>self.alpha</cite>,
and threshold <cite>self.threshold</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Generates random solution(s) for the classification problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of solutions to generate.
If 1 (default), returns a single solution vector.
If greater than 1, returns an array of solution vectors.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A NumPy array of shape (n_features,) if num_samples == 1,</dt><dd><p>or shape (num_samples, n_features) if num_samples &gt; 1, containing
random float32 values uniformly sampled from [0, 1).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">generate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.generate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Generates random velocity vectors for particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of velocity vectors to generate.
If 1 (default), returns a single vector of shape (n_features,).
If greater than 1, returns an array of shape (num_samples, n_features).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Random velocity vector(s) with values uniformly sampled from [-1, 1].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">initialize_pheromones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.initialize_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Initializes the pheromone parameters for each feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing two numpy arrays:</dt><dd><ul class="simple">
<li><p>means (np.ndarray): Randomly initialized means for each feature, sampled uniformly between 0 and 1.</p></li>
<li><p>stds (np.ndarray): Standard deviations for each feature, initialized to 0.2.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">mutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.mutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Applies mutation to a population matrix by randomly altering gene values.
Each mutation selects a random individual and gene, then adds Gaussian noise to the gene value,
clipping the result to the range [0, 1]. The number of mutations is determined by the mutation rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – The population matrix of shape (num_individuals, num_genes).</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em>) – The probability of mutation per individual (between 0 and 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The population is modified in place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Predicts the output for the given test data using the provided solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_test</strong> (<em>array-like</em>) – Test data to predict.</p></li>
<li><p><strong>solution</strong> (<em>object</em>) – Solution or model parameters to use for prediction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted values for the test data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">red_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.red_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Calculates the reduction rate for a given solution using the specified threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solution</strong> – The solution object or data structure to evaluate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduction rate computed by the utils.red_rate function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">reset_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.reset_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Resets the pheromone matrix to its initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pheromones</strong> – The current pheromone matrix (not used in this implementation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly initialized pheromone matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">update_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Updates the pheromone parameters (means and standard deviations) for an ant colony optimization algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pheromones</strong> (<em>tuple</em>) – A tuple containing the current means and standard deviations (means, stds) of the pheromone model.</p></li>
<li><p><strong>colony</strong> (<em>np.ndarray</em>) – The current population of solutions (ants), shape (n_ants, n_features).</p></li>
<li><p><strong>fitness_values</strong> (<em>list</em><em> or </em><em>np.ndarray</em>) – Fitness values for each solution in the colony. Lower values indicate better solutions.</p></li>
<li><p><strong>evaporation_rate</strong> (<em>float</em>) – The rate at which pheromone information evaporates (decays) in each iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated means and standard deviations (new_means, new_stds) for the pheromone model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Fitness values are normalized and inverted to compute weights, so better solutions have higher influence.</p></li>
<li><p>Means are updated using a weighted average of the colony, favoring better solutions.</p></li>
<li><p>Standard deviations are updated using the elite subset of the colony to maintain exploration.</p></li>
<li><p>Standard deviations are clipped to remain within predefined bounds (MIN_STD, MAX_STD).</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">update_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Updates the positions of individuals in the population based on their velocities,
applying boundary conditions and ensuring all positions remain within [0, 1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – The current positions of the population.</p></li>
<li><p><strong>velocity</strong> (<em>np.ndarray</em>) – The velocities to apply to the population.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated positions of the population, clipped to the [0, 1] range.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If an updated position goes out of bounds ([0, 1]), the velocity is reversed and halved (simulating a bounce),
and the position is updated again.</p></li>
<li><p>All positions are clipped to ensure they remain within the valid range.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/clas_problem.html#ClasProblem.update_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Updates the velocity of particles in a Particle Swarm Optimization (PSO) algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – Current positions of the particles.</p></li>
<li><p><strong>velocity</strong> (<em>np.ndarray</em>) – Current velocities of the particles.</p></li>
<li><p><strong>p_best</strong> (<em>np.ndarray</em>) – Personal best positions of the particles.</p></li>
<li><p><strong>g_best</strong> (<em>np.ndarray</em>) – Global best position found by the swarm.</p></li>
<li><p><strong>inertia_weight</strong> (<em>float</em>) – Inertia weight factor controlling exploration and exploitation.</p></li>
<li><p><strong>cognitive_weight</strong> (<em>float</em>) – Cognitive coefficient (particle’s own experience).</p></li>
<li><p><strong>social_weight</strong> (<em>float</em>) – Social coefficient (swarm’s experience).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated velocities for the particles, clipped to the range [-MAX_V, MAX_V].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-TFG.problems.problem">
<span id="tfg-problems-problem-module"></span><h2>TFG.problems.problem module<a class="headerlink" href="#module-TFG.problems.problem" title="Link to this heading"></a></h2>
<p>Module: problem</p>
<p>This module defines an abstract base class <cite>Problem</cite> for representing optimization or search problems,
providing a standardized interface for solution generation and fitness evaluation. It also includes
optional methods for leveraging different computational backends (OpenMP, GPU, Hybrid) for fitness
calculation. Additionally, the module provides a utility function <cite>patch_problem</cite> for dynamically
adding methods to instances of <cite>Problem</cite> or its subclasses.</p>
<section id="classes">
<h3>Classes:<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>Problem (ABC): Abstract base class for defining optimization/search problems.</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Methods:</dt><dd><p>__init__(): Initializes environment variables for CUDA acceleration.
generate_solution(num_samples=1): Abstract method to generate candidate solutions.
fitness(solutions): Abstract method to evaluate fitness of solutions.
fitness_omp(solutions): Optional, raises NotImplementedError by default.
fitness_gpu(solutions): Optional, raises NotImplementedError by default.
fitness_hybrid(solutions, speedup=1): Optional, raises NotImplementedError by default.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>Functions:</dt><dd><p>patch_problem(problem): Decorator factory to dynamically add methods to a Problem instance.
- The <cite>Problem</cite> class is intended to be subclassed with concrete implementations for solution</p>
<blockquote>
<div><p>generation and fitness evaluation.</p>
</div></blockquote>
<ul class="simple">
<li><p>Environment variables for CUDA are set in the constructor to facilitate GPU acceleration.</p></li>
<li><p>The <cite>patch_problem</cite> function allows for runtime extension of Problem instances with new methods.</p></li>
</ul>
</dd>
</dl>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TFG.problems.problem.</span></span><span class="sig-name descname"><span class="pre">Problem</span></span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for defining optimization or search problems.
This class provides a template for problem definitions that require solution generation and evaluation (fitness).
It also includes optional methods for evaluating solutions using different computational backends (OpenMP, GPU, Hybrid).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.None">
<span class="sig-name descname"><span class="pre">None</span></span><a class="headerlink" href="#TFG.problems.problem.Problem.None" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.generate_solution">
<span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem.generate_solution" title="Link to this definition"></a></dt>
<dd><p>Abstract method to generate one or more candidate solutions for the problem.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.fitness">
<span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem.fitness" title="Link to this definition"></a></dt>
<dd><p>Abstract method to evaluate the fitness of one or more solutions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.fitness_omp">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem.fitness_omp" title="Link to this definition"></a></dt>
<dd><p>Optional method to evaluate fitness using OpenMP parallelization.
Raises NotImplementedError by default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.fitness_gpu">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem.fitness_gpu" title="Link to this definition"></a></dt>
<dd><p>Optional method to evaluate fitness using GPU acceleration.
Raises NotImplementedError by default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.problem.Problem.fitness_hybrid">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.Problem.fitness_hybrid" title="Link to this definition"></a></dt>
<dd><p>Optional method to evaluate fitness using a hybrid approach (e.g., CPU+GPU).
Raises NotImplementedError by default.</p>
</dd></dl>

<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Sets CUDA-related environment variables in the constructor to configure GPU acceleration.</p></li>
<li><p>Intended to be subclassed with concrete implementations for solution generation and fitness evaluation.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="id18">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness value(s) for the given solution(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>Any</em>) – The solution or collection of solutions to evaluate. The type and structure depend on the problem context.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed fitness value(s) corresponding to the input solutions. The return type depends on the implementation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the method is not implemented in a subclass.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should be overridden by subclasses to provide problem-specific fitness evaluation logic.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness of the given solutions using GPU acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> – An iterable or array-like object containing the solutions to evaluate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fitness values corresponding to each solution.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented for GPU computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness of a set of solutions using a hybrid evaluation method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> (<em>iterable</em>) – A collection of candidate solutions to be evaluated.</p></li>
<li><p><strong>speedup</strong> (<em>float</em><em>, </em><em>optional</em>) – A factor to accelerate the fitness computation. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed fitness value(s) for the provided solutions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the method is not implemented.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should be implemented in subclasses to provide a hybrid fitness evaluation strategy.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness of the given solutions using an OpenMP-based approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>iterable</em>) – A collection of candidate solutions to be evaluated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed fitness value(s) for the provided solutions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the method is not implemented.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is intended to leverage OpenMP for parallel computation of fitness values.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#Problem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Generates one or more solutions for the problem instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of solutions to generate. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of generated solutions if num_samples &gt; 1, otherwise a single solution object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list or object</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the method is not implemented.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.problem.patch_problem">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.problem.</span></span><span class="sig-name descname"><span class="pre">patch_problem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/problem.html#patch_problem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.problem.patch_problem" title="Link to this definition"></a></dt>
<dd><p>Adds a method to an instance of the Problem class or its subclasses.
This function acts as a decorator factory that checks if the provided <cite>problem</cite> argument
is an instance of the <cite>Problem</cite> class (or its subclasses). It returns a decorator that,
when applied to a function, attaches that function as a method to the given <cite>problem</cite> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>problem</strong> – An instance of the Problem class or its subclasses to which the method will be added.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If <cite>problem</cite> is not an instance of Problem or its subclasses.</p></li>
<li><p><strong>TypeError</strong> – If the decorated object is not callable.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A decorator that adds the decorated function as a method to the <cite>problem</cite> instance.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-TFG.problems.tsp_problem">
<span id="tfg-problems-tsp-problem-module"></span><h2>TFG.problems.tsp_problem module<a class="headerlink" href="#module-TFG.problems.tsp_problem" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">TFG.problems.tsp_problem.</span></span><span class="sig-name descname"><span class="pre">TSPProblem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#TFG.problems.problem.Problem" title="TFG.problems.problem.Problem"><code class="xref py py-class docutils literal notranslate"><span class="pre">Problem</span></code></a></p>
<p>TSPProblem implements the Traveling Salesman Problem (TSP) for use in metaheuristic algorithms such as Ant Colony Optimization (ACO) and Particle Swarm Optimization (PSO), supporting both CPU and GPU execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distances</strong> (<em>np.ndarray</em>) – A 2D array representing the distance matrix between cities.</p></li>
<li><p><strong>executer</strong> (<em>str</em><em>, </em><em>optional</em>) – Execution mode: ‘single’ (CPU), ‘multi’ (multi-core CPU), or ‘gpu’ (GPU, default).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.distances">
<span class="sig-name descname"><span class="pre">distances</span></span><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.distances" title="Link to this definition"></a></dt>
<dd><p>The distance matrix on CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.distances_gpu">
<span class="sig-name descname"><span class="pre">distances_gpu</span></span><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.distances_gpu" title="Link to this definition"></a></dt>
<dd><p>The distance matrix on GPU (if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.n_cities">
<span class="sig-name descname"><span class="pre">n_cities</span></span><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.n_cities" title="Link to this definition"></a></dt>
<dd><p>Number of cities in the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.execution">
<span class="sig-name descname"><span class="pre">execution</span></span><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.execution" title="Link to this definition"></a></dt>
<dd><p>Selected execution mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.generate_solution">
<span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.generate_solution" title="Link to this definition"></a></dt>
<dd><p>Generates one or more random TSP solutions (permutations), always starting from city 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.fitness">
<span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.fitness" title="Link to this definition"></a></dt>
<dd><p>Computes the total distance (fitness) of one or more TSP solutions using CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.fitness_omp">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.fitness_omp" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness using an OpenMP-accelerated function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.fitness_gpu">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.fitness_gpu" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness using a GPU-accelerated function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.fitness_hybrid">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.fitness_hybrid" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness using a hybrid CPU/GPU approach.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.crossover">
<span class="sig-name descname"><span class="pre">crossover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.crossover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.crossover" title="Link to this definition"></a></dt>
<dd><p>Applies crossover to the population using a GPU/CPU-agnostic method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.crossover_cpu">
<span class="sig-name descname"><span class="pre">crossover_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.crossover_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.crossover_cpu" title="Link to this definition"></a></dt>
<dd><p>Applies crossover to the population using a CPU implementation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.mutation">
<span class="sig-name descname"><span class="pre">mutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.mutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.mutation" title="Link to this definition"></a></dt>
<dd><p>Applies swap mutation to the population.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.initialize_pheromones">
<span class="sig-name descname"><span class="pre">initialize_pheromones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.initialize_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.initialize_pheromones" title="Link to this definition"></a></dt>
<dd><p>Initializes the pheromone matrix on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.initialize_pheromones_cpu">
<span class="sig-name descname"><span class="pre">initialize_pheromones_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.initialize_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.initialize_pheromones_cpu" title="Link to this definition"></a></dt>
<dd><p>Initializes the pheromone matrix on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.construct_solutions">
<span class="sig-name descname"><span class="pre">construct_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions" title="Link to this definition"></a></dt>
<dd><p>Constructs solutions using ACO on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu">
<span class="sig-name descname"><span class="pre">construct_solutions_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu" title="Link to this definition"></a></dt>
<dd><p>Constructs solutions using ACO on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu_multi">
<span class="sig-name descname"><span class="pre">construct_solutions_cpu_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions_cpu_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.construct_solutions_cpu_multi" title="Link to this definition"></a></dt>
<dd><p>Constructs solutions using ACO on multi-core CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_pheromones">
<span class="sig-name descname"><span class="pre">update_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_pheromones" title="Link to this definition"></a></dt>
<dd><p>Updates pheromones on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_pheromones_cpu">
<span class="sig-name descname"><span class="pre">update_pheromones_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_pheromones_cpu" title="Link to this definition"></a></dt>
<dd><p>Updates pheromones on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.reset_pheromones">
<span class="sig-name descname"><span class="pre">reset_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.reset_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.reset_pheromones" title="Link to this definition"></a></dt>
<dd><p>Resets pheromones on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.reset_pheromones_cpu">
<span class="sig-name descname"><span class="pre">reset_pheromones_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.reset_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.reset_pheromones_cpu" title="Link to this definition"></a></dt>
<dd><p>Resets pheromones on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.generate_velocity">
<span class="sig-name descname"><span class="pre">generate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.generate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.generate_velocity" title="Link to this definition"></a></dt>
<dd><p>Generates initial random swap sequences (velocities) for PSO.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_velocity">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_velocity" title="Link to this definition"></a></dt>
<dd><p>Updates particle velocities for PSO on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_velocity_cpu">
<span class="sig-name descname"><span class="pre">update_velocity_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_velocity_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_velocity_cpu" title="Link to this definition"></a></dt>
<dd><p>Updates particle velocities for PSO on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.two_opt_cpu">
<span class="sig-name descname"><span class="pre">two_opt_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.two_opt_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.two_opt_cpu" title="Link to this definition"></a></dt>
<dd><p>Applies the 2-opt local search to tours on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.two_opt">
<span class="sig-name descname"><span class="pre">two_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.two_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.two_opt" title="Link to this definition"></a></dt>
<dd><p>Applies the 2-opt local search to tours on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_position">
<span class="sig-name descname"><span class="pre">update_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_position" title="Link to this definition"></a></dt>
<dd><p>Applies velocity swaps and 2-opt to update swarm positions on GPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_position_cpu">
<span class="sig-name descname"><span class="pre">update_position_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_position_cpu" title="Link to this definition"></a></dt>
<dd><p>Applies velocity swaps and 2-opt to update swarm positions on CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TFG.problems.tsp_problem.TSPProblem.update_position_cpu_multi">
<span class="sig-name descname"><span class="pre">update_position_cpu_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position_cpu_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#TFG.problems.tsp_problem.TSPProblem.update_position_cpu_multi" title="Link to this definition"></a></dt>
<dd><p>Applies velocity swaps and 2-opt to update swarm positions on multi-core CPU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">construct_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Constructs a batch of TSP solutions using an Ant Colony Optimization (ACO) approach on the GPU.</p>
<p>This method generates <cite>colony_size</cite> candidate solutions for the Traveling Salesman Problem (TSP)
by simulating the probabilistic construction of tours based on pheromone and heuristic information.
The computation is accelerated using GPU arrays and a custom CUDA kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colony_size</strong> (<em>int</em>) – Number of solutions (ants) to construct in parallel.</p></li>
<li><p><strong>pheromones</strong> (<em>array-like</em>) – 2D array of pheromone values for each edge.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Exponent for the influence of pheromone values.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Exponent for the influence of heuristic information (inverse distance).</p></li>
<li><p><strong>out</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Optional output array to store the resulting solutions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Array of shape (colony_size, n_cities) containing the constructed tours,</dt><dd><p>where each row is a permutation of city indices representing a tour.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses GPU acceleration via CuPy for efficient computation.</p></li>
<li><p>The method updates internal heuristic matrices if <cite>beta</cite> changes.</p></li>
<li><p>If <cite>out</cite> is provided, results are written in-place and also returned.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">construct_solutions_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd><p>Constructs a set of solutions for the TSP problem using Ant Colony Optimization (ACO) on the CPU.
This method generates <cite>colony_size</cite> solutions (tours) by simulating the behavior of ants,
where each ant incrementally builds a tour based on pheromone trails and heuristic information.
The function supports reusing an output array and efficiently updates the heuristic matrix
only when the <cite>beta</cite> parameter changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colony_size</strong> (<em>int</em>) – The number of solutions (ants) to construct.</p></li>
<li><p><strong>pheromones</strong> (<em>np.ndarray</em>) – A 2D array of shape (n_cities, n_cities) representing the pheromone levels on each edge.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The exponent applied to pheromone values in the transition probability calculation.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The exponent applied to heuristic values (inverse distance) in the transition probability calculation.</p></li>
<li><p><strong>out</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – An optional preallocated array of shape (colony_size, n_cities) to store the constructed solutions.
If None, a new array is allocated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>solutions</strong> – An array of shape (colony_size, n_cities) containing the constructed tours, where each row
represents a sequence of city indices visited by an ant.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method precomputes a heuristic matrix (inverse distance raised to <cite>beta</cite>) and only updates it
if <cite>beta</cite> changes from the previous call.</p></li>
<li><p>Random numbers for solution construction are precomputed for efficiency.</p></li>
<li><p>The actual construction of solutions is delegated to the <cite>utils.construct_solutions_tsp_inner_cpu</cite> function.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">construct_solutions_cpu_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colony_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.construct_solutions_cpu_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd><p>Constructs multiple TSP solutions in parallel on the CPU using an Ant Colony Optimization (ACO) approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colony_size</strong> (<em>int</em>) – The number of solutions (ants) to construct in parallel.</p></li>
<li><p><strong>pheromones</strong> (<em>np.ndarray</em>) – A 2D array representing the pheromone levels between cities.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The exponent for the influence of pheromone trails.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The exponent for the influence of heuristic information (inverse distance).</p></li>
<li><p><strong>out</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – An optional preallocated output array to store the constructed solutions.
If None, a new array is created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>solutions</strong> – An array of shape (colony_size, n_cities) containing the constructed TSP solutions,
where each row represents a tour (sequence of city indices).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This method precomputes the heuristic matrix for the given beta value and caches it for efficiency.</p></li>
<li><p>The construction process is randomized and uses a different random seed on each call.</p></li>
<li><p>The actual solution construction is performed by the <cite>utils.construct_solutions_tsp_inner</cite> function.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">crossover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.crossover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd><p>Performs crossover operation on a population of TSP solutions.
This method selects pairs of individuals from the population and applies a crossover
operation to generate new offspring. The crossover points are randomly chosen for each
pair, ensuring that the starting city (city 0) is not altered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – The current population of TSP solutions, where each individual
is represented as a sequence of city indices.</p></li>
<li><p><strong>crossover_rate</strong> (<em>float</em>) – The proportion of the population to undergo crossover, in the
range [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new population after applying the crossover operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">crossover_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.crossover_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd><p>Performs ordered crossover (OX) on a population of individuals for the Traveling Salesman Problem (TSP).
This method modifies the given population in-place by applying the ordered crossover operator to pairs of parents,
producing new offspring that inherit segments from both parents while preserving the order and uniqueness of cities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – A 2D NumPy array of shape (population_size, n_cities), where each row represents a tour (permutation of cities).</p></li>
<li><p><strong>crossover_rate</strong> (<em>float</em>) – The proportion of the population to undergo crossover, in the range [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified population array after crossover.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The number of crossovers performed is determined by <cite>crossover_rate * len(population) / 2</cite>.</p></li>
<li><p>Each crossover operates on consecutive pairs of individuals in the population.</p></li>
<li><p>The crossover is performed in-place, replacing parents with their offspring.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness value(s) for one or more TSP solutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>np.ndarray</em>) – A single solution (1D array) or multiple solutions (2D array)
representing the order of cities in the TSP route(s).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The fitness value for the solution if a single solution is provided,</dt><dd><p>or an array of fitness values if multiple solutions are provided.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses the <cite>utils.fitness_tsp</cite> function to compute the fitness based on the provided distances.</p></li>
<li><p>If <cite>solutions</cite> is a 1D array, returns a single fitness value.</p></li>
<li><p>If <cite>solutions</cite> is a 2D array, returns an array of fitness values, one for each solution.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">fitness_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness values for a batch of TSP solutions using GPU acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>np.ndarray</em>) – An array of TSP solutions (routes), where each solution is a sequence of city indices.
Can be a 1D array (single solution) or 2D array (batch of solutions).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fitness values (total route distances) for each solution. Returns a float if a single solution
was provided, or a 1D numpy array of floats for a batch of solutions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method leverages GPU computation via CuPy and custom CUDA kernels for efficient evaluation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_hybrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id30" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness values for a set of TSP solutions using a hybrid CPU/GPU approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solutions</strong> (<em>np.ndarray</em>) – An array of TSP solutions. Each solution is typically a permutation of city indices.</p></li>
<li><p><strong>speedup</strong> (<em>int</em><em>, </em><em>optional</em>) – A parameter to control the speedup factor for the GPU computation. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>np.float32 or np.ndarray: The fitness value(s) for the provided solution(s). Returns a single float if a single solution is provided, or an array of floats for multiple solutions.</p></li>
<li><p>int: The potentially updated speedup value after computation.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Utilizes GPU acceleration for fitness computation via the <cite>utils_gpu.fitness_tsp_hybrid</cite> function.</p></li>
<li><p>If a single solution is provided (1D array), returns a single fitness value; otherwise, returns an array of fitness values.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.fitness_omp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd><p>Calculates the fitness value(s) for one or more TSP solutions using an optimized parallel method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solutions</strong> (<em>np.ndarray</em>) – A single solution (1D array) or a batch of solutions (2D array) representing TSP tours.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fitness value for the provided solution(s). Returns a single float if a single solution is provided, or a NumPy array of floats for multiple solutions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses a parallelized implementation (<cite>utils.fitness_tsp_omp</cite>) to efficiently compute fitness values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">generate_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.generate_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd><p>Generates one or more random solutions (tours) for the Traveling Salesman Problem (TSP),
always starting from city 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of solutions to generate. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>If num_samples == 1: A 1D array representing a single tour, starting at city 0.</p></li>
<li><p>If num_samples &gt; 1: A 2D array of shape (num_samples, n_cities), where each row is a tour starting at city 0.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">generate_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.generate_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd><p>Generates a list of random swap operations (velocities) for use in permutation-based optimization algorithms.</p>
<p>Each velocity is represented as a list of tuple pairs, where each tuple (i, j) indicates a swap between the i-th and j-th cities in the tour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of velocity samples to generate. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing ‘num_samples’ velocity samples. Each sample is a list of swap operations (tuples of city indices).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[list[tuple[int, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">initialize_pheromones</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.initialize_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id34" title="Link to this definition"></a></dt>
<dd><p>Initializes the pheromone matrix for the TSP problem.</p>
<p>The pheromone values are randomly initialized between 1/(n_cities^2) and 1/n_cities
for each pair of cities, except for the diagonal (i.e., pheromones[i, i]), which is set to 0
to prevent self-loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A (n_cities, n_cities) matrix of pheromone values with zeros on the diagonal.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">initialize_pheromones_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.initialize_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id35" title="Link to this definition"></a></dt>
<dd><p>Initializes the pheromone matrix for the TSP problem on the CPU.</p>
<p>The pheromone values are randomly initialized between 1/(n_cities^2) and 1/n_cities
for each pair of cities, except for the diagonal, which is set to 0 to prevent
pheromone trails on self-loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A (n_cities, n_cities) matrix representing the initial pheromone levels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">mutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.mutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id36" title="Link to this definition"></a></dt>
<dd><p>Applies swap mutation to a subset of individuals in the population.
For each selected individual, two random positions (excluding the first city)
are chosen and their values are swapped, introducing variation in the population.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population</strong> (<em>np.ndarray</em>) – 2D array of shape (n_individuals, n_cities) representing the current population,
where each row is a permutation of city indices.</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em>) – Probability (between 0 and 1) that determines the fraction of individuals to mutate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The population is modified in place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">reset_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.reset_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id37" title="Link to this definition"></a></dt>
<dd><p>Resets the pheromone matrix with random values for an Ant Colony Optimization algorithm.</p>
<p>The pheromone values are initialized uniformly at random between 1/(n_cities^2) and 1/n_cities,
where n_cities is the number of cities in the problem. The diagonal elements, representing
self-loops, are set to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pheromones</strong> (<em>cp.ndarray</em>) – The current pheromone matrix (not used in this implementation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reset pheromone matrix with new random values and zero diagonal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id38">
<span class="sig-name descname"><span class="pre">reset_pheromones_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.reset_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id38" title="Link to this definition"></a></dt>
<dd><p>Resets the pheromone matrix for the TSP problem on the CPU by assigning random values within a specified range.</p>
<p>The pheromone values are initialized uniformly at random between 1/(n_cities^2) and 1/n_cities for each pair of cities,
except for the diagonal elements, which are set to 0 (no self-loops).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pheromones</strong> (<em>np.ndarray</em>) – The current pheromone matrix (not used in this implementation).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reset pheromone matrix with updated values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id39">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">two_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.two_opt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id39" title="Link to this definition"></a></dt>
<dd><p>Optimizes a batch of tours using the 2-opt algorithm on the GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tours</strong> (<em>numpy.ndarray</em>) – Array of shape (num_tours, n) representing the initial tours.</p></li>
<li><p><strong>distances</strong> (<em>cupy.ndarray</em>) – 2D array of shape (n, n) containing the distance matrix, stored on the GPU.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of optimized tours with the same shape as the input <cite>tours</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function uses a custom CUDA kernel (<cite>two_opt_kernel</cite>) to perform the optimization in parallel.</p></li>
<li><p>The input <cite>tours</cite> is transferred to the GPU, processed, and the result is copied back to the CPU.</p></li>
<li><p>The function assumes that <cite>distances</cite> is already a CuPy array on the GPU.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id40">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">two_opt_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tours</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.two_opt_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id40" title="Link to this definition"></a></dt>
<dd><p>Performs a single iteration of the 2-opt optimization algorithm on a batch of TSP tours.</p>
<p>This function attempts to improve each tour in the input by reversing a single segment
if it results in a shorter total tour length, according to the provided distance matrix.
Only the first improving move found for each tour is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tours</strong> (<em>np.ndarray</em>) – A 2D numpy array of shape (batch_size, n), where each row represents
a tour as a sequence of city indices.</p></li>
<li><p><strong>distances</strong> (<em>np.ndarray</em>) – A 2D numpy array of shape (n, n) representing the distance matrix
between cities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The potentially improved batch of tours, with the same shape as the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">update_pheromones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_pheromones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id41" title="Link to this definition"></a></dt>
<dd><p>Updates the pheromone matrix based on the solutions found by the colony and their fitness values.
This method performs global pheromone evaporation and deposits new pheromones along the paths taken by each solution in the colony.
The amount of pheromone deposited is inversely proportional to the fitness value of each solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pheromones</strong> (<em>cp.ndarray</em>) – The current pheromone matrix (2D array) representing pheromone levels between cities.</p></li>
<li><p><strong>colony</strong> (<em>np.ndarray</em><em> or </em><em>cp.ndarray</em>) – Array of shape (n_solutions, n_cities) where each row is a tour (sequence of city indices).</p></li>
<li><p><strong>fitness_values</strong> (<em>np.ndarray</em><em> or </em><em>cp.ndarray</em>) – Array of shape (n_solutions,) containing the fitness (e.g., tour length) for each solution.</p></li>
<li><p><strong>evaporation_rate</strong> (<em>float</em>) – The rate at which pheromones evaporate globally (between 0 and 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated pheromone matrix after evaporation and deposition.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id42">
<span class="sig-name descname"><span class="pre">update_pheromones_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_pheromones_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id42" title="Link to this definition"></a></dt>
<dd><p>Updates the pheromone matrix for the TSP problem using the provided colony and fitness values.</p>
<p>This method applies pheromone evaporation and deposits new pheromones based on the solutions
found by the colony of ants. The update is performed on the CPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pheromones</strong> (<em>np.ndarray</em>) – The current pheromone matrix representing the desirability of each edge.</p></li>
<li><p><strong>colony</strong> (<em>np.ndarray</em>) – The collection of solutions (paths) generated by the ants.</p></li>
<li><p><strong>fitness_values</strong> (<em>np.ndarray</em>) – The fitness (quality) of each solution in the colony.</p></li>
<li><p><strong>evaporation_rate</strong> (<em>float</em>) – The rate at which pheromones evaporate from the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated pheromone matrix after evaporation and deposition.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id43">
<span class="sig-name descname"><span class="pre">update_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id43" title="Link to this definition"></a></dt>
<dd><p>Updates the positions of a swarm of tours by applying a sequence of swap operations (velocity) to each tour.
Each element in the velocity list corresponds to a list of swap operations for a tour in the swarm.
After applying all swaps, the method performs a 2-opt optimization on the entire swarm to further improve the tours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swarm</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – The current population of tours, where each tour is a list of city indices.</p></li>
<li><p><strong>velocity</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>tuple</em>) – The velocity for each tour, represented as a list of swap operations (tuples of indices).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated swarm after applying the velocity and 2-opt optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id44">
<span class="sig-name descname"><span class="pre">update_position_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id44" title="Link to this definition"></a></dt>
<dd><p>Updates the positions of a swarm of tours by applying a sequence of swap operations (velocity) to each tour,
and then refines the tours using the 2-opt local search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swarm</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – The current population of tours, where each tour is a list of city indices.</p></li>
<li><p><strong>velocity</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>tuple</em><em> of </em><em>int</em>) – The velocity for each tour, represented as a list of swap operations.
Each swap operation is a tuple (a, b) indicating the indices in the tour to be swapped.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated swarm of tours after applying the velocity swaps and 2-opt optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id45">
<span class="sig-name descname"><span class="pre">update_position_cpu_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_position_cpu_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id45" title="Link to this definition"></a></dt>
<dd><p>Updates the positions of a swarm of tours by applying a series of swap operations (velocity) to each tour,
then performs a 2-opt optimization on the entire swarm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swarm</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – The current population of tours, where each tour is a list of city indices.</p></li>
<li><p><strong>velocity</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>tuple</em>) – The velocity for each tour, represented as a list of swap operations (tuples of indices).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated swarm after applying the swaps and 2-opt optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">update_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id46" title="Link to this definition"></a></dt>
<dd><p>Updates the velocity of each particle in the swarm for the TSP Particle Swarm Optimization algorithm.
The velocity is represented as a sequence of swap operations that, when applied to a tour, move it towards better solutions.
The new velocity is computed as a combination of three components:</p>
<blockquote>
<div><ul class="simple">
<li><p>Inertia: retains part of the previous velocity.</p></li>
<li><p>Cognitive: moves the particle towards its personal best solution.</p></li>
<li><p>Social: moves the particle towards the global best solution.</p></li>
</ul>
</div></blockquote>
<p>Duplicate swaps are removed, and the total number of swaps is limited based on the number of cities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swarm</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – Current population of tours (particles), each represented as a list of city indices.</p></li>
<li><p><strong>velocity</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>tuple</em>) – Current velocities for each particle, where each velocity is a list of swap operations.</p></li>
<li><p><strong>p_best</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – Personal best tours found by each particle.</p></li>
<li><p><strong>g_best</strong> (<em>list</em><em> of </em><em>int</em>) – Global best tour found by the swarm.</p></li>
<li><p><strong>inertia_weight</strong> (<em>float</em>) – Weight for the inertia component.</p></li>
<li><p><strong>cognitive_weight</strong> (<em>float</em>) – Weight for the cognitive component.</p></li>
<li><p><strong>social_weight</strong> (<em>float</em>) – Weight for the social component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated velocities for each particle, each as a list of swap operations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list of tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id47">
<span class="sig-name descname"><span class="pre">update_velocity_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_best</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inertia_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cognitive_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">social_weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/TFG/problems/tsp_problem.html#TSPProblem.update_velocity_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id47" title="Link to this definition"></a></dt>
<dd><p>Updates the velocity of each particle in the swarm for the TSP using the Particle Swarm Optimization (PSO) algorithm.
This method computes the new velocity for each particle by combining three components:
- Inertia: Retains part of the previous velocity.
- Cognitive: Moves the particle towards its personal best solution.
- Social: Moves the particle towards the global best solution.
The velocity is represented as a sequence of swap operations that transform the current tour towards the target tour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swarm</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – Current population of tours (particles), each represented as a list of city indices.</p></li>
<li><p><strong>velocity</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>tuple</em>) – Current velocities for each particle, where each velocity is a list of swap operations (tuples).</p></li>
<li><p><strong>p_best</strong> (<em>list</em><em> of </em><em>list</em><em> of </em><em>int</em>) – Personal best tours found by each particle.</p></li>
<li><p><strong>g_best</strong> (<em>list</em><em> of </em><em>int</em>) – Global best tour found by the swarm.</p></li>
<li><p><strong>inertia_weight</strong> (<em>float</em>) – Weight for the inertia component (previous velocity).</p></li>
<li><p><strong>cognitive_weight</strong> (<em>float</em>) – Weight for the cognitive component (personal best).</p></li>
<li><p><strong>social_weight</strong> (<em>float</em>) – Weight for the social component (global best).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated velocities for each particle, each as a list of swap operations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list of tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-TFG.problems.utils">
<span id="tfg-problems-utils-module"></span><h2>TFG.problems.utils module<a class="headerlink" href="#module-TFG.problems.utils" title="Link to this heading"></a></h2>
<p>C++ utility module for optimization tasks, including classification and TSP-specific operations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.clas_rate">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">clas_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils.clas_rate" title="Link to this definition"></a></dt>
<dd><p>Computes the classification rate given a set of selected features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.construct_solutions_tsp_inner">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">construct_solutions_tsp_inner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visited</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.uint8</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heuristic_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.construct_solutions_tsp_inner" title="Link to this definition"></a></dt>
<dd><p>Constructs TSP solutions using the ACO probabilistic model (parallel version).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.construct_solutions_tsp_inner_cpu">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">construct_solutions_tsp_inner_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visited</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.uint8</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheromones</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heuristic_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.construct_solutions_tsp_inner_cpu" title="Link to this definition"></a></dt>
<dd><p>Constructs TSP solutions using the ACO probabilistic model on CPU.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.crossover_tsp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">crossover_tsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_starts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#TFG.problems.utils.crossover_tsp" title="Link to this definition"></a></dt>
<dd><p>Performs crossover on a population of TSP solutions based on given start and end indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.fitness">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils.fitness" title="Link to this definition"></a></dt>
<dd><p>Computes the combined fitness function for feature selection, based on classification and reduction rates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.fitness_omp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">fitness_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.fitness_omp" title="Link to this definition"></a></dt>
<dd><p>Computes the combined fitness function using OpenMP parallelism for feature selection tasks.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.fitness_tsp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">fitness_tsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils.fitness_tsp" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness (i.e., total distance) of a single TSP tour.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.fitness_tsp_omp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">fitness_tsp_omp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.fitness_tsp_omp" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness of multiple TSP tours using OpenMP parallelism.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.get_swap_sequence">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">get_swap_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_tour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_tour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#TFG.problems.utils.get_swap_sequence" title="Link to this definition"></a></dt>
<dd><p>Generates the swap sequence required to transform one TSP tour into another.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.mutation_tsp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">mutation_tsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.mutation_tsp" title="Link to this definition"></a></dt>
<dd><p>Performs mutation on a population of TSP solutions using swap operations.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.predict">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#TFG.problems.utils.predict" title="Link to this definition"></a></dt>
<dd><p>Performs prediction on test data using a 1-NN classifier with weighted features.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.red_rate">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">red_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils.red_rate" title="Link to this definition"></a></dt>
<dd><p>Computes the feature reduction rate based on a selection threshold.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.two_opt">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">two_opt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tours</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils.two_opt" title="Link to this definition"></a></dt>
<dd><p>Applies the 2-opt local search optimization to a batch of TSP tours.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils.update_pheromones_tsp">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils.</span></span><span class="sig-name descname"><span class="pre">update_pheromones_tsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pheromones</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colony</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaporation_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#TFG.problems.utils.update_pheromones_tsp" title="Link to this definition"></a></dt>
<dd><p>Updates the pheromone matrix in ACO based on solution quality and evaporation.</p>
</dd></dl>

</section>
<section id="module-TFG.problems.utils_gpu">
<span id="tfg-problems-utils-gpu-module"></span><h2>TFG.problems.utils_gpu module<a class="headerlink" href="#module-TFG.problems.utils_gpu" title="Link to this heading"></a></h2>
<p>CUDA-accelerated utility module for optimization tasks, including TSP and classification.</p>
<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.create_capsule">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">create_capsule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr_address</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">capsule</span></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.create_capsule" title="Link to this definition"></a></dt>
<dd><p>Creates a CUDA memory capsule from a raw pointer for efficient memory reuse.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.fitness_cuda">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">fitness_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.fitness_cuda" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness for feature selection tasks using a CUDA kernel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.fitness_hybrid">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">fitness_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train_capsule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train_capsule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.fitness_hybrid" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness for feature selection using a hybrid CUDA+CPU strategy with memory capsules.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.fitness_tsp_cuda">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">fitness_tsp_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_solutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.fitness_tsp_cuda" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness (total distance) of TSP solutions using a CUDA kernel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.fitness_tsp_hybrid">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">fitness_tsp_hybrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances_capsule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">capsule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_solutions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedup_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.fitness_tsp_hybrid" title="Link to this definition"></a></dt>
<dd><p>Computes the fitness of TSP solutions using a hybrid CUDA+CPU strategy with optional memory capsule.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="TFG.problems.utils_gpu.warmup">
<span class="sig-prename descclassname"><span class="pre">TFG.problems.utils_gpu.</span></span><span class="sig-name descname"><span class="pre">warmup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#TFG.problems.problem.Problem.None" title="TFG.problems.problem.Problem.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#TFG.problems.utils_gpu.warmup" title="Link to this definition"></a></dt>
<dd><p>Initializes and warms up the GPU to avoid cold-start latency during execution.</p>
</dd></dl>

</section>
<section id="module-TFG.problems">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-TFG.problems" title="Link to this heading"></a></h2>
<p>This module initializes the problems package and exposes key classes and utilities.</p>
<dl class="simple">
<dt>Imports:</dt><dd><p>Problem, patch_problem (from .problem): Base class and patching utility for problem definitions.
ClasProblem (from .clas_problem): Class for classification problems.
TSPProblem (from .tsp_problem): Class for Traveling Salesman Problem instances.
utils: General utility functions for problem handling.
utils_gpu: GPU-specific utility functions for problem handling.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, IsaaHack.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>